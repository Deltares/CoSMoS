<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cht.delft3dfm.delft3dfm &mdash; CoSMoS 0.1 documentation</title><link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            CoSMoS
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual.html">User manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions.html">Functions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">CoSMoS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">cht.delft3dfm.delft3dfm</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for cht.delft3dfm.delft3dfm</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Sat May 15 08:08:40 2021</span>

<span class="sd">@author: ormondt</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="c1">#import gdal</span>
<span class="c1">#import subprocess</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1">#from matplotlib import pyplot as plt</span>
<span class="kn">from</span> <span class="nn">pandas.tseries.offsets</span> <span class="kn">import</span> <span class="n">DateOffset</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">pyproj</span> <span class="kn">import</span> <span class="n">CRS</span>
<span class="kn">from</span> <span class="nn">pyproj</span> <span class="kn">import</span> <span class="n">Transformer</span>

<span class="kn">from</span> <span class="nn">cht.misc.geometry</span> <span class="kn">import</span> <span class="n">RegularGrid</span>
<span class="kn">from</span> <span class="nn">cht.misc.geometry</span> <span class="kn">import</span> <span class="n">Point</span>
<span class="kn">from</span> <span class="nn">cht.misc.deltares_ini</span> <span class="kn">import</span> <span class="n">IniStruct</span>

<div class="viewcode-block" id="Delft3DFM"><a class="viewcode-back" href="../../../_generated/cosmos.cosmos_delft3dfm.Delft3DFM.html#cosmos.cosmos_delft3dfm.Delft3DFM">[docs]</a><span class="k">class</span> <span class="nc">Delft3DFM</span><span class="p">:</span>
    
<div class="viewcode-block" id="Delft3DFM.__init__"><a class="viewcode-back" href="../../../_generated/cosmos.cosmos_delft3dfm.Delft3DFM.html#cosmos.cosmos_delft3dfm.Delft3DFM.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
 
<span class="c1">#        self.epsg                     = epsg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mdu</span>                      <span class="o">=</span> <span class="n">MDU</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span>                    <span class="o">=</span> <span class="n">Delft3DFMInput</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mdu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span>                      <span class="o">=</span> <span class="n">crs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span>                     <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>                     <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span>                 <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">observation_point</span>        <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obstacle</span>                 <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meteo</span>                    <span class="o">=</span> <span class="n">Delft3DFMMeteo</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">input_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputfile</span><span class="p">):</span>
        <span class="c1"># Reads sfincs.inp and attribute files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_input_file</span><span class="p">(</span><span class="n">inputfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_attribute_files</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">read_input_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_file</span><span class="p">):</span>
        
        <span class="c1"># Reads mdu file</span>
        
        <span class="c1"># Get the path of sfincs.inp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
        
        <span class="c1"># Read file (ini format)</span>
        <span class="n">d</span><span class="o">=</span><span class="n">IniStruct</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">input_file</span><span class="p">)</span>
        
        <span class="c1"># Defaults have already been set, so only loop over entries in mdu file</span>
        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">section</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">section</span><span class="o">.</span><span class="n">keyword</span><span class="p">:</span>
                <span class="c1"># Look up keyword in mdu table</span>
                <span class="k">for</span> <span class="n">mdu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mdu</span><span class="o">.</span><span class="n">dict</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">mdu</span><span class="p">[</span><span class="s2">&quot;keyword&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">keyword</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">keyword</span><span class="o">.</span><span class="n">value</span>
                        <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">mdu</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;float&quot;</span><span class="p">:</span>
                                <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">mdu</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;int&quot;</span><span class="p">:</span>
                                <span class="n">val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">mdu</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;date&quot;</span><span class="p">:</span>
                                <span class="n">val</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(),</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">mdu</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span>
                            
                        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">mdu</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">val</span><span class="p">)</span>                       
                        <span class="k">break</span>
        
        <span class="c1"># Adjust start and stop times to Python datetime</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">tstart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">refdate</span> <span class="o">+</span> \
            <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">tstart</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">tstop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">refdate</span> <span class="o">+</span> \
            <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">tstop</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_input_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">input_file</span><span class="p">:</span>
            <span class="n">input_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;test.mdu&quot;</span><span class="p">)</span>
        
        <span class="c1"># Store input data in ini structure        </span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">IniStruct</span><span class="p">()</span>
        <span class="c1"># Loop through all the keywords in the mdu table</span>
        <span class="k">for</span> <span class="n">mdu</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mdu</span><span class="o">.</span><span class="n">dict</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">mdu</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
            <span class="n">d</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">mdu</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">],</span> <span class="n">mdu</span><span class="p">[</span><span class="s2">&quot;keyword&quot;</span><span class="p">],</span> <span class="n">val</span><span class="p">,</span> <span class="n">mdu</span><span class="p">[</span><span class="s2">&quot;comment&quot;</span><span class="p">])</span>
        
        <span class="c1"># Adjust start and stop time to seconds    </span>
        <span class="n">t0</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">tstart</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">refdate</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">tstop</span>  <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">refdate</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
        <span class="n">d</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;TStart&quot;</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="s2">&quot;Start time w.r.t. RefDate (in TUnit)&quot;</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;TStop&quot;</span><span class="p">,</span>  <span class="n">t1</span><span class="p">,</span> <span class="s2">&quot;Stop time w.r.t. RefDate (in TUnit)&quot;</span><span class="p">)</span>
                
        <span class="n">d</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>            
                       
    <span class="k">def</span> <span class="nf">read_attribute_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Grid</span>
<span class="c1">#        self.grid = SfincsGrid()</span>

        <span class="c1"># External forcing (boundary conditions)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">extforcefilenew</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_ext_file_new</span><span class="p">()</span>
        
<span class="c1">#        # External forcing (meteo)</span>
<span class="c1">#        if self.input.extforcefile:</span>
<span class="c1">#            self.read_ext_file()</span>


        <span class="c1"># Flow boundary conditions</span>
<span class="c1">#        self.read_flow_boundary_points()</span>
<span class="c1">#        self.read_flow_boundary_conditions()</span>

        <span class="c1"># Observation points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_observation_points</span><span class="p">()</span>

<span class="c1">#        self.grid.compute_coordinates(x0,y0,dx,dy,nx,ny,rotation)</span>
        <span class="k">pass</span>
    

<span class="c1">##### Boundary points #####</span>

    <span class="k">def</span> <span class="nf">read_ext_file_new</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">ext_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">extforcefilenew</span><span class="p">)</span>

        <span class="n">d</span><span class="o">=</span><span class="n">IniStruct</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">ext_file</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">section</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;boundary&quot;</span><span class="p">:</span>
                <span class="c1"># New boundary found</span>
                <span class="n">bnd</span> <span class="o">=</span> <span class="n">Delft3DFMBoundary</span><span class="p">(</span><span class="n">quantity</span><span class="o">=</span><span class="n">section</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">),</span>
                                        <span class="n">locationfile</span><span class="o">=</span><span class="n">section</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;locationfile&quot;</span><span class="p">),</span>
                                        <span class="n">forcingfile</span><span class="o">=</span><span class="n">section</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s2">&quot;forcingfile&quot;</span><span class="p">))</span>                
                <span class="n">bnd</span><span class="o">.</span><span class="n">read_location_file</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
                <span class="n">bnd</span><span class="o">.</span><span class="n">read_forcing_file</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>                
                <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bnd</span><span class="p">)</span>


    <span class="c1"># def read_flow_boundary_points(self):</span>
        
    <span class="c1">#     # Read SFINCS bnd file</span>
        
    <span class="c1">#     self.flow_boundary_point = []</span>
        
    <span class="c1">#     if not self.input.bndfile:</span>
    <span class="c1">#         return</span>
                    
    <span class="c1">#     bnd_file = os.path.join(self.path,</span>
    <span class="c1">#                             self.input.bndfile)</span>

    <span class="c1">#     if not os.path.exists(bnd_file):</span>
    <span class="c1">#         return</span>
        
    <span class="c1">#     # Read the bnd file</span>
    <span class="c1">#     df = pd.read_csv(bnd_file, index_col=False, header=None,</span>
    <span class="c1">#          delim_whitespace=True, names=[&#39;x&#39;, &#39;y&#39;])</span>
        
    <span class="c1">#     # Loop through points</span>
    <span class="c1">#     for ind in range(len(df.x.values)):</span>
    <span class="c1">#         name = str(ind + 1).zfill(4)</span>
    <span class="c1">#         point = FlowBoundaryPoint(df.x.values[ind],</span>
    <span class="c1">#                                   df.y.values[ind],</span>
    <span class="c1">#                                   name=name)</span>
    <span class="c1">#         self.flow_boundary_point.append(point)</span>

    <span class="c1"># def write_flow_boundary_points(self, file_name=None):</span>

    <span class="c1">#     # Write SFINCS bnd file</span>
    <span class="c1">#     if not file_name:</span>
    <span class="c1">#         if not self.input.bndfile:</span>
    <span class="c1">#             return</span>
    <span class="c1">#         file_name = os.path.join(self.path,</span>
    <span class="c1">#                                  self.input.bndfile)</span>
            
    <span class="c1">#     if not file_name:</span>
    <span class="c1">#         return</span>
            
    <span class="c1">#     fid = open(file_name, &quot;w&quot;)</span>
    <span class="c1">#     for point in self.flow_boundary_point:</span>
    <span class="c1">#         string = f&#39;{point.geometry.x:12.1f}{point.geometry.y:12.1f}&quot;\n&#39;</span>
    <span class="c1">#         fid.write(string)</span>
    <span class="c1">#     fid.close()    </span>

    <span class="c1"># ### Flow Boundary points ###</span>
    
    <span class="c1"># def read_flow_boundary_conditions(self, file_name=None):</span>

    <span class="c1">#     # Read SFINCS bzs file</span>
        
    <span class="c1">#     if not file_name:</span>
    <span class="c1">#         if not self.input.bzsfile:</span>
    <span class="c1">#             return</span>
    <span class="c1">#         file_name = os.path.join(self.path,</span>
    <span class="c1">#                                  self.input.bzsfile)</span>
            
    <span class="c1">#     if not file_name:</span>
    <span class="c1">#         return</span>
        
    <span class="c1">#     if not os.path.exists(file_name):</span>
    <span class="c1">#         return</span>
        
    <span class="c1">#     if not self.input.tref:</span>
    <span class="c1">#         # tref has not yet been defined</span>
    <span class="c1">#         return</span>

    <span class="c1">#     df = read_timeseries_file(file_name, self.input.tref)</span>

    <span class="c1">#     ts  = df.index</span>
    <span class="c1">#     for icol, point in enumerate(self.flow_boundary_point):</span>
    <span class="c1">#         point.data = pd.Series(df.iloc[:,icol].values, index=ts)</span>
        
    <span class="k">def</span> <span class="nf">write_boundary_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        
        <span class="c1"># Write Delft3D-FM bc file (there can be only ONE bc file !!!)</span>

        <span class="kn">from</span> <span class="nn">deltares_ini</span> <span class="kn">import</span> <span class="n">Section</span>
        <span class="kn">from</span> <span class="nn">deltares_ini</span> <span class="kn">import</span> <span class="n">Keyword</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>
        
        <span class="n">frc_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">forcingfile</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">frc_file</span><span class="p">)</span>
            
        <span class="n">d</span><span class="o">=</span><span class="n">IniStruct</span><span class="p">()</span>
        
        <span class="n">trefstr</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">refdate</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H%M%S&quot;</span><span class="p">)</span>
        <span class="n">tunitstr</span> <span class="o">=</span> <span class="s2">&quot;seconds since &quot;</span> <span class="o">+</span> <span class="n">trefstr</span>
        <span class="n">vunitstr</span> <span class="o">=</span> <span class="s2">&quot;m&quot;</span>
    
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">bnd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary</span><span class="p">):</span>        

            <span class="n">bnd</span><span class="o">.</span><span class="n">forcingfile</span> <span class="o">=</span> <span class="n">frc_file</span>

            <span class="k">for</span> <span class="n">ip</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bnd</span><span class="o">.</span><span class="n">point</span><span class="p">):</span>
                
                <span class="n">s</span><span class="o">=</span><span class="n">Section</span><span class="p">()</span>
                <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;forcing&quot;</span>
                <span class="n">s</span><span class="o">.</span><span class="n">keyword</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">point</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
                <span class="n">s</span><span class="o">.</span><span class="n">keyword</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Function&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;timeseries&quot;</span><span class="p">))</span>
                <span class="n">s</span><span class="o">.</span><span class="n">keyword</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Time-interpolation&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">))</span>
                <span class="n">s</span><span class="o">.</span><span class="n">keyword</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Quantity&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">))</span>
                <span class="n">s</span><span class="o">.</span><span class="n">keyword</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Unit&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">tunitstr</span><span class="p">))</span>
                <span class="n">s</span><span class="o">.</span><span class="n">keyword</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Quantity&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">bnd</span><span class="o">.</span><span class="n">quantity</span><span class="p">))</span>
                <span class="n">s</span><span class="o">.</span><span class="n">keyword</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Keyword</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Unit&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">vunitstr</span><span class="p">))</span>
                
                <span class="n">data</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">tmsec</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">refdate</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
                <span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">tmsec</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
                <span class="n">s</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
                
                <span class="n">d</span><span class="o">.</span><span class="n">section</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            
        <span class="n">d</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>            
<span class="c1">#            point_names.append(point.name)                        </span>
<span class="c1">#        # Return DataFrame bzs</span>
<span class="c1">#        bzs = overall.read_timeseries_output(name_list=point_names,</span>
<span class="c1">#                                             path=output_path,</span>
<span class="c1">#                                             file_name=output_file)</span>
        <span class="c1"># ts  = bzs.index</span>
        <span class="c1"># for ip, point in enumerate(bnd.point):</span>
        <span class="c1">#     point.data = pd.Series(bzs.iloc[:,ip].values, index=ts) + boundary_water_level_correction    </span>

        
        <span class="c1"># # Build a new DataFrame</span>
        <span class="c1"># df = pd.DataFrame()</span>
        <span class="c1"># for point in self.flow_boundary_point:</span>
        <span class="c1">#     df = pd.concat([df, point.data], axis=1)</span>
        <span class="c1"># tmsec = pd.to_timedelta(df.index - self.input.tref, unit=&quot;s&quot;)</span>
        <span class="c1"># df.index = tmsec.total_seconds()</span>
        <span class="c1"># df.to_csv(file_name,</span>
        <span class="c1">#           index=True,</span>
        <span class="c1">#           sep=&quot; &quot;,</span>
        <span class="c1">#           header=False,</span>
        <span class="c1">#           float_format=&quot;%0.3f&quot;)</span>

    <span class="c1"># def read_astro_boundary_conditions(self, file_name=None):</span>

    <span class="c1">#     # Read SFINCS bca file</span>
    <span class="c1">#     if not file_name:</span>
    <span class="c1">#         if not self.input.bcafile:</span>
    <span class="c1">#             return</span>
    <span class="c1">#         file_name = os.path.join(self.path,</span>
    <span class="c1">#                                  self.input.bcafile)</span>
            
    <span class="c1">#     if not file_name:</span>
    <span class="c1">#         return</span>
        
    <span class="c1">#     if not os.path.exists(file_name):</span>
    <span class="c1">#         return</span>

    <span class="c1">#     d = IniStruct(filename=file_name)</span>
    <span class="c1">#     for ind, point in enumerate(self.flow_boundary_point):</span>
    <span class="c1">#         point.astro = d.section[ind].data</span>

    <span class="k">def</span> <span class="nf">write_ext_meteo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="c1"># Write Delft3D-FM ext file (meteo)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">extforcefile</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">extforcefile</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="k">return</span>
            
        <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meteo</span><span class="o">.</span><span class="n">amu_file</span><span class="p">:</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;QUANTITY=windx</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;FILENAME=&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">meteo</span><span class="o">.</span><span class="n">amu_file</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;FILETYPE=4</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;METHOD=2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;OPERAND=O</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meteo</span><span class="o">.</span><span class="n">amv_file</span><span class="p">:</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;QUANTITY=windy</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;FILENAME=&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">meteo</span><span class="o">.</span><span class="n">amv_file</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;FILETYPE=4</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;METHOD=2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;OPERAND=O</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">meteo</span><span class="o">.</span><span class="n">amp_file</span><span class="p">:</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;QUANTITY=atmosphericpressure</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;FILENAME=&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">meteo</span><span class="o">.</span><span class="n">amp_file</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;FILETYPE=4</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;METHOD=2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;OPERAND=O</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>    

    <span class="c1">### Observation points ###</span>

    <span class="k">def</span> <span class="nf">add_observation_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">observation_point</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ObservationPoint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">read_observation_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">observation_point</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">obsfile</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">obsfile</span><span class="p">)</span>
                            
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning : file &quot;</span> <span class="o">+</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot; does not exist !&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="c1"># Loop through points</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">])</span>
        
        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">)):</span>
            <span class="n">point</span> <span class="o">=</span> <span class="n">ObservationPoint</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span>
                                     <span class="n">df</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span>
                                     <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">ind</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">observation_point</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_observation_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>
            
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">obsfile</span>
            
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>    

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">is_geographic</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>    
            <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_point</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s1">12.1f</span><span class="si">}{</span><span class="n">point</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span><span class="si">:</span><span class="s1">12.1f</span><span class="si">}</span><span class="s1">  &quot;</span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">observation_point</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span><span class="si">:</span><span class="s1">12.6f</span><span class="si">}{</span><span class="n">point</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span><span class="si">:</span><span class="s1">12.6f</span><span class="si">}</span><span class="s1">  &quot;</span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            <span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
            
    <span class="c1">### Output ###</span>

    <span class="k">def</span> <span class="nf">read_timeseries_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                               <span class="n">name_list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                               <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">file_name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                               <span class="n">file_name_wave</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

        <span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

        <span class="c1"># Returns a dataframe with timeseries    </span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runid</span> <span class="o">+</span> <span class="s2">&quot;_his.nc&quot;</span>

        <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
    
<span class="c1">#        if not self.observation_point:</span>
<span class="c1">#            # First read observation points</span>
<span class="c1">#            self.read_observation_points()</span>
                    
        <span class="c1"># Open netcdf file</span>
        <span class="n">ddd</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">stations</span><span class="o">=</span><span class="n">ddd</span><span class="o">.</span><span class="n">waterlevel</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;station_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">all_stations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ist</span><span class="p">,</span> <span class="n">st</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">stations</span><span class="p">):</span>
            <span class="n">st</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">st</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">all_stations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
        
        <span class="c1"># If name_list is empty, add all points    </span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name_list</span><span class="p">:</span>
            <span class="n">name_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="n">all_stations</span><span class="p">:</span>
                <span class="n">name_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>      
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name_wave</span><span class="p">:</span>
            <span class="n">times</span>   <span class="o">=</span> <span class="n">ddd</span><span class="o">.</span><span class="n">waterlevel</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">name_list</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ist</span><span class="p">,</span> <span class="n">st</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_stations</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">station</span> <span class="o">==</span> <span class="n">st</span><span class="p">:</span>
                        <span class="n">wl</span> <span class="o">=</span> <span class="n">ddd</span><span class="o">.</span><span class="n">waterlevel</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="n">ist</span><span class="p">]</span>
                        <span class="n">wl</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">wl</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">999.0</span>
                        <span class="n">df</span><span class="p">[</span><span class="n">st</span><span class="p">]</span><span class="o">=</span><span class="n">wl</span>
                        <span class="k">break</span>            

            <span class="n">ddd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ddd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">ddd</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">file_name_wave</span><span class="p">):</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="n">ddd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
            
            <span class="n">times</span>   <span class="o">=</span> <span class="n">ddd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Hsig</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            
            <span class="n">df</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ist</span><span class="p">,</span> <span class="n">st</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">all_stations</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">station</span> <span class="o">==</span> <span class="n">st</span><span class="p">:</span>

                        <span class="n">df</span><span class="p">[</span><span class="n">st</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hs&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">])</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">file_name_wave</span><span class="p">):</span> <span class="c1"># Loop to get most detailed model with output at station location</span>
                            <span class="n">Hs</span> <span class="o">=</span> <span class="n">ddd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">Hsig</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="n">ist</span><span class="p">]</span>
                            <span class="n">Tp</span> <span class="o">=</span> <span class="n">ddd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">RTpeak</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="n">ist</span><span class="p">]</span>
                            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">Hs</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">999</span><span class="p">:</span>
                                <span class="k">break</span>
                        <span class="n">Tp</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">Hs</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">999.0</span>
                        <span class="n">Hs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">Hs</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">999.0</span>
                        <span class="n">df</span><span class="p">[</span><span class="n">st</span><span class="p">][</span><span class="s2">&quot;hs&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">Hs</span>
                        <span class="n">df</span><span class="p">[</span><span class="n">st</span><span class="p">][</span><span class="s2">&quot;tp&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">Tp</span>                       
                        <span class="k">break</span>    
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">file_name_wave</span><span class="p">):</span>        
                <span class="n">ddd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">df</span>     

    <span class="k">def</span> <span class="nf">grid_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;cor&#39;</span><span class="p">):</span>

        <span class="n">cosrot</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">rotation</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
        <span class="n">sinrot</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">rotation</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">loc</span><span class="o">==</span><span class="s2">&quot;cor&quot;</span><span class="p">:</span>
            <span class="n">xx</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">mmax</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span>
                                 <span class="n">num</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">mmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">yy</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">nmax</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">dy</span><span class="p">,</span>
                                 <span class="n">num</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xx</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">mmax</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">dx</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span>
                                 <span class="n">num</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">mmax</span><span class="p">)</span>
            <span class="n">yy</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">dy</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">nmax</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">dy</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">dy</span><span class="p">,</span>
                                 <span class="n">num</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">nmax</span><span class="p">)</span>
            
        <span class="n">xg0</span><span class="p">,</span> <span class="n">yg0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        <span class="n">xg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">xg0</span><span class="o">*</span><span class="n">cosrot</span> <span class="o">-</span> <span class="n">yg0</span><span class="o">*</span><span class="n">sinrot</span>
        <span class="n">yg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">xg0</span><span class="o">*</span><span class="n">sinrot</span> <span class="o">+</span> <span class="n">yg0</span><span class="o">*</span><span class="n">cosrot</span>

        <span class="k">return</span> <span class="n">xg</span><span class="p">,</span> <span class="n">yg</span>
    
    <span class="k">def</span> <span class="nf">bounding_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="n">xg</span><span class="p">,</span> <span class="n">yg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_coordinates</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;cor&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">crs</span><span class="p">:</span>
            <span class="n">transformer</span> <span class="o">=</span> <span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
                                               <span class="n">crs</span><span class="p">,</span>
                                               <span class="n">always_xy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">xg</span><span class="p">,</span> <span class="n">yg</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">)</span>
        
        <span class="n">x_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">xg</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">xg</span><span class="p">))]</span>
        <span class="n">y_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">yg</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">yg</span><span class="p">))]</span>
        
        <span class="k">return</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span>

    <span class="k">def</span> <span class="nf">outline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="n">xg</span><span class="p">,</span> <span class="n">yg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_coordinates</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;cor&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">crs</span><span class="p">:</span>
            <span class="n">transformer</span> <span class="o">=</span> <span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
                                               <span class="n">crs</span><span class="p">,</span>
                                               <span class="n">always_xy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">xg</span><span class="p">,</span> <span class="n">yg</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">)</span>
        
        <span class="n">xp</span> <span class="o">=</span> <span class="p">[</span> <span class="n">xg</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">xg</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">xg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">xg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">xg</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span>
        <span class="n">yp</span> <span class="o">=</span> <span class="p">[</span> <span class="n">yg</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">yg</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">yg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">yg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">yg</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span>
        
        <span class="k">return</span> <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span>
        
    <span class="k">def</span> <span class="nf">make_index_tiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">zoom_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        
        <span class="kn">from</span> <span class="nn">tiling</span> <span class="kn">import</span> <span class="n">deg2num</span>
        <span class="kn">from</span> <span class="nn">tiling</span> <span class="kn">import</span> <span class="n">num2deg</span>
        <span class="kn">import</span> <span class="nn">fileops</span> <span class="k">as</span> <span class="nn">fo</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">zoom_range</span><span class="p">:</span>
            <span class="n">zoom_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span>

        <span class="n">npix</span> <span class="o">=</span> <span class="mi">256</span>
        
        <span class="c1"># Compute lon/lat range</span>
        <span class="n">lon_range</span><span class="p">,</span> <span class="n">lat_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">CRS</span><span class="o">.</span><span class="n">from_epsg</span><span class="p">(</span><span class="mi">4326</span><span class="p">))</span>
        
        <span class="n">cosrot</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">rotation</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
        <span class="n">sinrot</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">rotation</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>       
        
        <span class="n">transformer_a</span> <span class="o">=</span> <span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span><span class="n">CRS</span><span class="o">.</span><span class="n">from_epsg</span><span class="p">(</span><span class="mi">4326</span><span class="p">),</span>
                                             <span class="n">CRS</span><span class="o">.</span><span class="n">from_epsg</span><span class="p">(</span><span class="mi">3857</span><span class="p">),</span>
                                             <span class="n">always_xy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">transformer_b</span> <span class="o">=</span> <span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span><span class="n">CRS</span><span class="o">.</span><span class="n">from_epsg</span><span class="p">(</span><span class="mi">3857</span><span class="p">),</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
                                             <span class="n">always_xy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">izoom</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">zoom_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">zoom_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Processing zoom level &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">izoom</span><span class="p">))</span>
        
            <span class="n">zoom_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">izoom</span><span class="p">))</span>
        
            <span class="n">dxy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">40075016.686</span><span class="o">/</span><span class="n">npix</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">izoom</span>
            <span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="n">npix</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dxy</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">npix</span><span class="p">)</span>
            <span class="n">yy</span> <span class="o">=</span> <span class="n">xx</span><span class="p">[:]</span>
            <span class="n">xv</span><span class="p">,</span> <span class="n">yv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
        
            <span class="n">ix0</span><span class="p">,</span> <span class="n">iy0</span> <span class="o">=</span> <span class="n">deg2num</span><span class="p">(</span><span class="n">lat_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lon_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">izoom</span><span class="p">)</span>
            <span class="n">ix1</span><span class="p">,</span> <span class="n">iy1</span> <span class="o">=</span> <span class="n">deg2num</span><span class="p">(</span><span class="n">lat_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lon_range</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">izoom</span><span class="p">)</span>
        
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ix0</span><span class="p">,</span> <span class="n">ix1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            
                <span class="n">path_okay</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">zoom_path_i</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">zoom_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iy0</span><span class="p">,</span> <span class="n">iy1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            
                    <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">zoom_path_i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.dat&quot;</span><span class="p">)</span>
            
                    <span class="c1"># Compute lat/lon at ll corner of tile</span>
                    <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">num2deg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">izoom</span><span class="p">)</span>
            
                    <span class="c1"># Convert to Global Mercator</span>
                    <span class="n">xo</span><span class="p">,</span> <span class="n">yo</span>   <span class="o">=</span> <span class="n">transformer_a</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">)</span>
            
                    <span class="c1"># Tile grid on local mercator</span>
                    <span class="n">x</span>        <span class="o">=</span> <span class="n">xv</span><span class="p">[:]</span> <span class="o">+</span> <span class="n">xo</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dxy</span>
                    <span class="n">y</span>        <span class="o">=</span> <span class="n">yv</span><span class="p">[:]</span> <span class="o">+</span> <span class="n">yo</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dxy</span>
            
                    <span class="c1"># Convert tile grid to crs of SFINCS model</span>
                    <span class="n">x</span><span class="p">,</span><span class="n">y</span>      <span class="o">=</span> <span class="n">transformer_b</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
                    
                    <span class="c1"># Now rotate around origin of SFINCS model</span>
                    <span class="n">x00</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">x0</span>
                    <span class="n">y00</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">y0</span>
                    <span class="n">xg</span>  <span class="o">=</span> <span class="n">x00</span><span class="o">*</span><span class="n">cosrot</span> <span class="o">-</span> <span class="n">y00</span><span class="o">*</span><span class="n">sinrot</span>
                    <span class="n">yg</span>  <span class="o">=</span> <span class="n">x00</span><span class="o">*</span><span class="n">sinrot</span> <span class="o">+</span> <span class="n">y00</span><span class="o">*</span><span class="n">cosrot</span>
                    
                    <span class="n">iind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">xg</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
                    <span class="n">jind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">yg</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">dy</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
                    <span class="n">ind</span>  <span class="o">=</span> <span class="n">iind</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">nmax</span> <span class="o">+</span> <span class="n">jind</span>
                    <span class="n">ind</span><span class="p">[</span><span class="n">iind</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
                    <span class="n">ind</span><span class="p">[</span><span class="n">jind</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
                    <span class="n">ind</span><span class="p">[</span><span class="n">iind</span><span class="o">&gt;</span><span class="mi">255</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
                    <span class="n">ind</span><span class="p">[</span><span class="n">jind</span><span class="o">&gt;</span><span class="mi">255</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
<span class="c1">#                    ind           = np.ascontiguousarray(np.transpose(ind))</span>

                    <span class="c1"># if i==142 and j==305:</span>
                    
                    <span class="c1">#     from matplotlib import pyplot as plt</span>
                    <span class="c1">#     fig, ax = plt.subplots(1,1)                                            </span>
                    <span class="c1">#     ax.plot(x,y)</span>
                    <span class="c1">#     ax.plot(x.transpose(),y.transpose())</span>
                    <span class="c1">#     ax.axis(&#39;equal&#39;)</span>
                    <span class="c1">#     x_range, y_range = self.bounding_box()</span>
                    <span class="c1">#     xp = [x_range[0], x_range[1],x_range[1],x_range[0],x_range[0]]</span>
                    <span class="c1">#     yp = [y_range[0], y_range[0],y_range[1],y_range[1],y_range[0]]</span>
                    <span class="c1">#     ax.plot(xp,yp)</span>
                    <span class="c1">#     xout, yout = self.outline()</span>
                    <span class="c1">#     ax.plot(xout,yout)</span>
                    <span class="c1">#     fig, ax = plt.subplots(1,1)                                            </span>
                    <span class="c1">#     ax.pcolor(ind.reshape([256, 256]))</span>
                    <span class="c1">#     xxx=1</span>
                    
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">ind</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">):</span>
                        
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">path_okay</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">zoom_path_i</span><span class="p">):</span>
                                <span class="n">fo</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">zoom_path_i</span><span class="p">)</span>
                                <span class="n">path_okay</span> <span class="o">=</span> <span class="kc">True</span>
                             
                        <span class="c1"># And write indices to file</span>
                        <span class="n">fid</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
                        <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
                        <span class="n">fid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


    <span class="c1"># def read(self, file_name):</span>
    <span class="c1">#     inp = Delft3DFMInput() # default values</span>
    <span class="c1">#     return inp</span>
    
    <span class="c1"># def write(self, file_name, inp):</span>
    <span class="c1">#     return</span>

<span class="k">class</span> <span class="nc">Delft3DFMInput</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mdu</span><span class="p">):</span>
        
        <span class="n">mdu</span> <span class="o">=</span> <span class="n">MDU</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">mdu</span><span class="o">.</span><span class="n">dict</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">])</span>
        
<span class="k">class</span> <span class="nc">SfincsGrid</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">rotation</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">RegularGrid</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">rotation</span><span class="p">)</span>

    <span class="c1"># def plot(self,ax):</span>
    <span class="c1">#     self.geometry.plot(ax)</span>

    <span class="c1"># def corner_coordinates(self):</span>
    <span class="c1">#     x,y = self.geometry.grid_coordinates_corners()</span>
    <span class="c1">#     return x, y</span>

    <span class="c1"># def centre_coordinates(self):</span>
    <span class="c1">#     x,y = self.geometry.grid_coordinates_centres()</span>
    <span class="c1">#     return x, y</span>

<span class="k">class</span> <span class="nc">SfincsDepth</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">SfincsMask</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msk</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Delft3DFMBoundary</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">locationfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">forcingfile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span>     <span class="o">=</span> <span class="n">quantity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locationfile</span> <span class="o">=</span> <span class="n">locationfile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forcingfile</span>  <span class="o">=</span> <span class="n">forcingfile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span>     <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point</span>        <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">read_location_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="n">loc_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">locationfile</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">cht.misc.pli_file</span> <span class="kn">import</span> <span class="n">read_pli_file</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">read_pli_file</span><span class="p">(</span><span class="n">loc_file</span><span class="p">)</span>
<span class="c1">#        d = plifile(loc_file)</span>
        <span class="n">name0</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">loc_file</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">polyline</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ip</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">polyline</span><span class="o">.</span><span class="n">x</span><span class="p">):</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">name0</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ip</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
                <span class="n">point</span> <span class="o">=</span> <span class="n">Delft3DFMBoundaryPoint</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">polyline</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span>
                                               <span class="n">y</span><span class="o">=</span><span class="n">polyline</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span>
                                               <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>            
                <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">read_forcing_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>

        <span class="n">frc_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">forcingfile</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">frc_file</span><span class="p">):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">IniStruct</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">frc_file</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">):</span>
                <span class="n">point</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">section</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>        
        
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Delft3DFMBoundaryPoint</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span>       <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span>   <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span>       <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Use a pandas dataframe</span>
    
    
<span class="k">class</span> <span class="nc">SfincsFlowBoundaryConditions</span><span class="p">():</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bndfile</span><span class="p">,</span> <span class="n">bzsfile</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_points</span><span class="p">(</span><span class="n">bndfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_time_series</span><span class="p">(</span><span class="n">bzsfile</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">read_time_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">SfincsWaveBoundaryConditions</span><span class="p">():</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bndfile</span><span class="p">,</span> <span class="n">bzsfile</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_points</span><span class="p">(</span><span class="n">bndfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_time_series</span><span class="p">(</span><span class="n">bzsfile</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">read_time_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">set_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ax</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">FlowBoundaryPoint</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">astro</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span>                   <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span>               <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span>                   <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">astro</span>                  <span class="o">=</span> <span class="n">astro</span>

<span class="k">class</span> <span class="nc">ObservationPoint</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span>     <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Delft3DFMMeteo</span><span class="p">():</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">amu_file</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amv_file</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amp_file</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ampr_file</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">read_timeseries_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">ref_date</span><span class="p">):</span>
    
    <span class="c1"># Returns a dataframe with time series for each of the columns</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">ref_date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">ts</span>
    
    <span class="k">return</span> <span class="n">df</span>
    
<span class="k">class</span> <span class="nc">MDU</span><span class="p">():</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;program&quot;</span><span class="p">,</span>              <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Program&quot;</span><span class="p">,</span>          <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="s2">&quot;D-Flow FM&quot;</span><span class="p">,</span>     <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;model&quot;</span><span class="p">,</span>    <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;version&quot;</span><span class="p">,</span>              <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Version&quot;</span><span class="p">,</span>          <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="s2">&quot;1.1.154.42806&quot;</span><span class="p">,</span> <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;model&quot;</span><span class="p">,</span>    <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;mduformatversion&quot;</span><span class="p">,</span>     <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;MDUFormatVersion&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="s2">&quot;1.02&quot;</span><span class="p">,</span>          <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;model&quot;</span><span class="p">,</span>    <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;autostart&quot;</span><span class="p">,</span>            <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;AutoStart&quot;</span><span class="p">,</span>        <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;int&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>               <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;model&quot;</span><span class="p">,</span>    <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Autostart simulation after loading MDU or not (0=no, 1=autostart, 2=autostartstop).&quot;</span><span class="p">})</span>

        <span class="c1"># geometry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;netfile&quot;</span><span class="p">,</span>              <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;NetFile&quot;</span><span class="p">,</span>          <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;bathymetryfile&quot;</span><span class="p">,</span>       <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;BathymetryFile&quot;</span><span class="p">,</span>   <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;*.xyb&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;waterlevinifile&quot;</span><span class="p">,</span>      <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;WaterLevIniFile&quot;</span><span class="p">,</span>  <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Initial water levels sample file *.xyz&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;landboundaryfile&quot;</span><span class="p">,</span>     <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;LandBoundaryFile&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Only for plotting&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;thindamfile&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;ThinDamFile&quot;</span><span class="p">,</span>      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;*_thd.pli, Polyline(s) for tracing thin dams.&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;thindykefile&quot;</span><span class="p">,</span>         <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;ThindykeFile&quot;</span><span class="p">,</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;*._tdk.pli, Polyline(s) x,y,z, z = thin dyke top levels&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;proflocfile&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;ProflocFile&quot;</span><span class="p">,</span>      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;*_proflocation.xyz)    x,y,z, z = profile refnumber&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;profdeffile&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;ProfdefFile&quot;</span><span class="p">,</span>      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;*_profdefinition.def) definition for all profile nrs&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;manholefile&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;ManholeFile&quot;</span><span class="p">,</span>      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;waterlevini&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;WaterLevIni&quot;</span><span class="p">,</span>      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Initial water level&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;botlevuni&quot;</span><span class="p">,</span>            <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;BotLevUni&quot;</span><span class="p">,</span>        <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Uniform bottom level, (only if Botlevtype&gt;=3, used at missing z values in netfile&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;botlevtype&quot;</span><span class="p">,</span>           <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;BotLevType&quot;</span><span class="p">,</span>       <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;int&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>               <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;anglat&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;AngLat&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Angle of latitude (deg), 0=no Coriolis&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;conveyance2d&quot;</span><span class="p">,</span>         <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Conveyance2D&quot;</span><span class="p">,</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;int&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>               <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;-1:R=HU,0:R=H, 1:R=A/P, 2:K=analytic-1D conv, 3:K=analytic-2D conv&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;conveyance2d&quot;</span><span class="p">,</span>         <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Conveyance2D&quot;</span><span class="p">,</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;int&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>               <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;-1:R=HU,0:R=H, 1:R=A/P, 2:K=analytic-1D conv, 3:K=analytic-2D conv&quot;</span><span class="p">})</span>

        <span class="c1"># numerics</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;cflmax&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;CFLMax&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.7</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;numerics&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Max. Courant nr.&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;cflwavefrac&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;CFLWaveFrac&quot;</span><span class="p">,</span>      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;numerics&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Wave velocity fraction, total courant vel = u + cflw*wavevelocity&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;advectype&quot;</span><span class="p">,</span>            <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;AdvecType&quot;</span><span class="p">,</span>        <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;int&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>               <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;numerics&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Adv type, 0=no, 1= Wenneker, qu-udzt, 2=1, q(uio-u), 3=Perot q(uio-u), 4=Perot q(ui-u), 5=Perot q(ui-u) without itself&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;limtypsa&quot;</span><span class="p">,</span>             <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Limtypsa&quot;</span><span class="p">,</span>         <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;int&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>               <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;numerics&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Limiter type for salinity transport,           0=no, 1=minmod,2=vanLeer,3=Kooren,4=Monotone Central&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Hdam&quot;</span><span class="p">,</span>                 <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Hdam&quot;</span><span class="p">,</span>             <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;numerics&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Threshold for minimum bottomlevel step at which to apply energy conservation factor i.c. flow contraction&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Icgsolver&quot;</span><span class="p">,</span>            <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Icgsolver&quot;</span><span class="p">,</span>        <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">4.0</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;numerics&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Solver type (1: sobekGS_OMP, 2: sobekGS_OMPthreadsafe, 3: sobekGS, 4: sobekGS + Saadilud, 5: parallel/global Saad, 6: parallel/Petsc, 7: parallel/GS)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Tlfsmo&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Tlfsmo&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;numerics&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Fourier smoothing time on water level boundaries&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Qhrelax&quot;</span><span class="p">,</span>              <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Qhrelax&quot;</span><span class="p">,</span>          <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;numerics&quot;</span><span class="p">,</span> <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Relaxation on Q-h open boundaries&quot;</span><span class="p">})</span>

        <span class="c1"># physics</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;uniffrictcoef&quot;</span><span class="p">,</span>        <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;UnifFrictCoef&quot;</span><span class="p">,</span>    <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.02</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Uniform friction coefficient, 0=no friction&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;uniffrictcoef1D&quot;</span><span class="p">,</span>        <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;UnifFrictCoef1D&quot;</span><span class="p">,</span>    <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.02</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Uniform friction coefficient in 1D links, 0=no friction&quot;</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;uniffricttype&quot;</span><span class="p">,</span>        <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;UnifFrictType&quot;</span><span class="p">,</span>    <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;int&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>               <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;0=Chezy, 1=Manning, 2=White Colebrook, 3=z0 etc&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;vicouv&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Vicouv&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Uniform horizontal eddy viscosity&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;smagorinsky&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Smagorinsky&quot;</span><span class="p">,</span>      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Add Smagorinsky horizontal turbulence : vicu = vicu + ( (Smagorinsky*dx)**2)*S, e.g. 0.1&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;elder&quot;</span><span class="p">,</span>                <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Elder&quot;</span><span class="p">,</span>            <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Add Elder contribution                : vicu = vicu + Elder*kappa*ustar*H/6),   e.g. 1.0&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;wall_ks&quot;</span><span class="p">,</span>              <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;wall_ks&quot;</span><span class="p">,</span>          <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Nikuradse roughness for side walls, wall_z0=wall_ks/30&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;vicoww&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Vicoww&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">1.0e-06</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Uniform vertical eddy viscosity&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;dicoww&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Dicoww&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">1.0e-06</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Uniform vertical eddy diffusivity&quot;</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;tidalforcing&quot;</span><span class="p">,</span>         <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;TidalForcing&quot;</span><span class="p">,</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>               <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Tidal forcing (0=no, 1=yes) (only for jsferic == 1)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;salinity&quot;</span><span class="p">,</span>             <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Salinity&quot;</span><span class="p">,</span>         <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>               <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Include salinity, (0=no, 1=yes)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Temperature&quot;</span><span class="p">,</span>      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>               <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Include temperature (0: no, 1: only transport, 3: excess model of D3D, 5: composite (ocean) model)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;rhomean&quot;</span><span class="p">,</span>              <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Rhomean&quot;</span><span class="p">,</span>          <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">1024.0</span><span class="p">,</span>          <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Average water density (kg/m3)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;ag&quot;</span><span class="p">,</span>                   <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Ag&quot;</span><span class="p">,</span>               <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">9.81</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Gravitational acceleration&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;stanton&quot;</span><span class="p">,</span>              <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Stanton&quot;</span><span class="p">,</span>          <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0013</span><span class="p">,</span>          <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Coefficient for convective heat flux&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;dalton&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Dalton&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0013</span><span class="p">,</span>          <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Coefficient for evaporative heat flux&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;backgroundwatertemperature&quot;</span><span class="p">,</span> <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Backgroundwatertemperature&quot;</span><span class="p">,</span>  <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span>          <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;physics&quot;</span><span class="p">,</span>  <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Background water temperature for eqn. of state&quot;</span><span class="p">})</span>


        <span class="c1"># wind</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;icdtyp&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;ICdtyp&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;int&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>               <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;wind&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;( ), Cd = const, 2=S&amp;B 2 breakpoints, 3= S&amp;B 3 breakpoints&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;cdbreakpoints&quot;</span><span class="p">,</span>        <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Cdbreakpoints&quot;</span><span class="p">,</span>    <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;list&quot;</span><span class="p">,</span>     <span class="s2">&quot;default&quot;</span><span class="p">:[</span><span class="mf">1.0e-03</span><span class="p">,</span><span class="mf">3.1e-03</span><span class="p">,</span><span class="mf">1.5e-03</span><span class="p">],</span> <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;wind&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;( ),   e.g. 0.00063  0.00723&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;windspeedbreakpoints&quot;</span><span class="p">,</span> <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Windspeedbreakpoints&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;list&quot;</span><span class="p">,</span>  <span class="s2">&quot;default&quot;</span><span class="p">:[</span><span class="mf">0.0e+00</span><span class="p">,</span><span class="mf">2.8e+01</span><span class="p">,</span><span class="mf">5.0e+01</span><span class="p">],</span> <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;wind&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;(m/s), e.g. 0.0      100.0&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;pavbnd&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;PavBnd&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">1.013e+05</span><span class="p">,</span>       <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;wind&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Background pressure (Pa)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;rhoair&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Rhoair&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">1.2</span><span class="p">,</span>       <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;wind&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Air density&quot;</span><span class="p">})</span>

        <span class="c1"># waves</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;wavemodelnr&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Wavemodelnr&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;int&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>               <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;waves&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Wave model nr. (0: none, 1: fetch/depth limited Hurdle-Stive, 2: Young-Verhagen, 3: SWAN)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;wavenikuradse&quot;</span><span class="p">,</span>        <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;WaveNikuradse&quot;</span><span class="p">,</span>         <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;waves&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Wave friction Nikuradse ks c , used in Krone-Swart&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;rouwav&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Rouwav&quot;</span><span class="p">,</span>                <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="s2">&quot;FR84&quot;</span><span class="p">,</span>          <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;waves&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Friction model for wave induced shear stress&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;gammax&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Gammax&quot;</span><span class="p">,</span>                <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;waves&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Maximum wave height/water depth ratio&quot;</span><span class="p">})</span>

        <span class="c1"># time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;refdate&quot;</span><span class="p">,</span>              <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;RefDate&quot;</span><span class="p">,</span>         <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>  <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">20000101</span><span class="p">,</span>         <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Reference date (yyyymmdd)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;tunit&quot;</span><span class="p">,</span>                <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;Tunit&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>              <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Time units in MDU (H, M or S)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;dtuser&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;DtUser&quot;</span><span class="p">,</span>          <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">300.0</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;User timestep in seconds (interval for external forcing update)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;dtmax&quot;</span><span class="p">,</span>                <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;DtMax&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">300.0</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Max timestep in seconds&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;dtinit&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;DtInit&quot;</span><span class="p">,</span>          <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span>              <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Initial timestep in seconds&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;autotimestep&quot;</span><span class="p">,</span>         <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;AutoTimestep&quot;</span><span class="p">,</span>    <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;int&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>                <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Use CFL timestep limit or not (1/0)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;tstart&quot;</span><span class="p">,</span>               <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;TStart&quot;</span><span class="p">,</span>          <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>              <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Start time w.r.t. RefDate (in TUnit)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;tstop&quot;</span><span class="p">,</span>                <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;TStop&quot;</span><span class="p">,</span>           <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">86400.0</span><span class="p">,</span>          <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Stop time w.r.t. RefDate (in TUnit)&quot;</span><span class="p">})</span>
        
        <span class="c1"># restart</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;restartfile&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;RestartFile&quot;</span><span class="p">,</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;restart&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Restart netcdf-file, either *_rst.nc or *_map.nc&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;restartdatetime&quot;</span><span class="p">,</span>      <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;RestartDateTime&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>              <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;restart&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Restart date and time when restarting from *_map.nc [YYYY-MM-DD HH:MM:SS]&quot;</span><span class="p">})</span>

        <span class="c1"># external forcing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;extforcefile&quot;</span><span class="p">,</span>         <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;ExtForceFile&quot;</span><span class="p">,</span>    <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;external forcing&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;*.ext&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;extforcefilenew&quot;</span><span class="p">,</span>      <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;ExtForceFileNew&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;external forcing&quot;</span><span class="p">,</span>     <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;*.ext (new format)&quot;</span><span class="p">})</span>

        <span class="c1"># output</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;obsfile&quot;</span><span class="p">,</span>              <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;ObsFile&quot;</span><span class="p">,</span>         <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;*.xyn Coords+name of observation stations&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;crsfile&quot;</span><span class="p">,</span>              <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;CrsFile&quot;</span><span class="p">,</span>         <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;*_crs.pli Polyline(s) definining cross section(s)&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;hisfile&quot;</span><span class="p">,</span>              <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;HisFile&quot;</span><span class="p">,</span>         <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;*_his.nc History file in NetCDF format&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;hisinterval&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;HisInterval&quot;</span><span class="p">,</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">600.0</span><span class="p">,</span>            <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Interval (in s) between history outputs&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;xlsinterval&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;XLSInterval&quot;</span><span class="p">,</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>              <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Interval (in s) between XLS history&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;flowgeomfile&quot;</span><span class="p">,</span>         <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;FlowGeomFile&quot;</span><span class="p">,</span>    <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;*_flowgeom.nc Flow geometry file in NetCDF format&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;mapfile&quot;</span><span class="p">,</span>              <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;MapFile&quot;</span><span class="p">,</span>         <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;*_map.nc Map file in NetCDF format&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;mapinterval&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;MapInterval&quot;</span><span class="p">,</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">3600.0</span><span class="p">,</span>           <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Interval (in s) between map file outputs&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;rstinterval&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;RstInterval&quot;</span><span class="p">,</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>              <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Interval (in s) between restart file outputs&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;waqfilebase&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;WaqFileBase&quot;</span><span class="p">,</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Basename (without extension) for all Delwaq files to be written&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;waqinterval&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;WaqInterval&quot;</span><span class="p">,</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>              <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Interval (in s) between Delwaq file outputs&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;snapshotdir&quot;</span><span class="p">,</span>          <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;SnapshotDir&quot;</span><span class="p">,</span>     <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Directory where snapshots/screendumps are saved.&quot;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;outputdir&quot;</span><span class="p">,</span>            <span class="s2">&quot;keyword&quot;</span><span class="p">:</span><span class="s2">&quot;OutputDir&quot;</span><span class="p">,</span>       <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;str&quot;</span><span class="p">,</span>   <span class="s2">&quot;default&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>             <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>   <span class="s2">&quot;comment&quot;</span><span class="p">:</span><span class="s2">&quot;Output directory of map-, his-, rst-, dat- and timings-files, default: DFM_OUTPUT_&lt;modelname&gt;. Set to . for current dir.&quot;</span><span class="p">})</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Deltares.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>